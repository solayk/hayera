<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="AdminDAO">

	<select id="adminLogin" parameterType="admin" resultType="admin">
		<![CDATA[
		SELECT * FROM MANAGER WHERE MANAGER_ID = #{manager_id}
		]]>
	</select>

	<insert id="insertProduct" parameterType="product">
		<![CDATA[
		INSERT INTO PRODUCT(PROD_NO,PROD_NAME,BRAND,CATEGORY,PRICE,COST_PRICE,DISCOUNT_PRICE
		,CAPACITY,SCENT,SCENT_RATING,FEEL,FEEL_RATING,AVG_RATING,TOTALSALES,STOCK,IMG_URL,MANAGER_ID,PRODUCT_EXPLAIN) 
		VALUES (#{prod_no}, #{prod_name}, #{brand}, #{category}, #{price}, #{cost_price}, #{discount_price}
		, #{capacity}, #{scent}, 0, #{feel}, 0, 0, #{totalsales}, #{stock}, #{img_url}, 'admin', #{product_explain})
		]]>
	</insert>
	
	<select id="adminSearchProduct" parameterType="String" resultType="product">
		<![CDATA[
		SELECT * 
		FROM PRODUCT
		WHERE PROD_NAME LIKE '%'||#{value}||'%'
		]]>
	</select>
	
	<select id="adminEditTarget" parameterType="product" resultType="product">
		<![CDATA[
		SELECT * FROM PRODUCT WHERE PROD_NO = #{prod_no}
		]]>
	</select>
	
	<update id="adminEditProduct" parameterType="product">
		<![CDATA[
		UPDATE PRODUCT SET PROD_NAME = #{prod_name}, BRAND = #{brand}, CATEGORY = #{category}, PRICE = #{price}, COST_PRICE = #{cost_price}
		, DISCOUNT_PRICE = #{discount_price}, CAPACITY = #{capacity}, SCENT = #{scent}, FEEL = #{feel}, PRODUCT_EXPLAIN = #{product_explain} WHERE PROD_NO = #{prod_no}
		]]>
	</update>
	
	<delete id="adminRemoveProduct" parameterType="String">
		<![CDATA[
		DELETE 
		FROM PRODUCT
		WHERE PROD_NO = #{value}
		]]>
	</delete>
	
	<select id="viewAllCustomer" resultType="customer">
		<![CDATA[
		SELECT * FROM CUSTOMER
		]]>
	</select>
	
	<select id="adminCustomerEditTarget" parameterType="customer" resultType="customer">
		<![CDATA[
		SELECT * FROM CUSTOMER WHERE CUSTOMER_ID = #{customer_id}
		]]>
	</select>
	
	<update id="adminEditCustomer" parameterType="customer">
		<![CDATA[
		UPDATE CUSTOMER SET TEL = #{tel}, NAME = #{name}, EMAIL = #{email}, ADDRESS = #{address}, BIRTHDAY = #{birthday}, SKINTYPE = #{skintype}, POINTS = #{points}, GENDER = #{gender} WHERE CUSTOMER_ID = #{customer_id}
		]]>
	</update>
	
	<delete id="adminRemoveCustomer" parameterType="String">
		<![CDATA[
		DELETE 
		FROM CUSTOMER
		WHERE CUSTOMER_ID = #{value}
		]]>
	</delete>
	
	<select id="viewAllOrderlist" resultType="order">
		<![CDATA[
		SELECT * FROM ORDERLIST
		]]>
	</select>
	
	<select id="adminOrderEditTarget" parameterType="order" resultType="order">
		<![CDATA[
		SELECT * FROM ORDERLIST WHERE ORDER_NO = #{order_no}
		]]>
	</select>
	
	<update id="adminEditOrder" parameterType="order">
		<![CDATA[
		UPDATE ORDERLIST SET RECEIVE = #{receive}, ORDER_STATUS = #{order_status}, DELIVERY_DATE = #{delivery_date}, DELIVERY_STATUS = #{delivery_status}, ORDER_ADDRESS = #{order_address} WHERE ORDER_NO = #{order_no}
		]]>
	</update>
	
	<update id="adminEditDeliveryStatus" parameterType="order">
		<![CDATA[
		UPDATE ORDERLIST SET DELIVERY_DATE = SYSDATE, DELIVERY_STATUS = '발송완료' WHERE ORDER_NO = #{order_no}
		]]>
	</update>
	
	<select id="viewAllInquiry" parameterType="qna" resultType="qna">
		SELECT I.INQUIRY_ID INQUIRY_ID, P.PROD_NO PROD_NO, P.PROD_NAME PROD_NAME, P.IMG_URL IMG_URL, 
		I.CUSTOMER_ID CUSTOMER_ID, I.CONTENTS CONTENTS, I.QNADAY QNADAY,
		R.CONTENTS REPLY_CONTENTS, R.REPLYDAY REPLYDAY
		FROM INQUIRY I 
		INNER JOIN PRODUCT P ON <![CDATA[I.PROD_NO = P.PROD_NO]]> 
		LEFT OUTER JOIN INQUIRY_REPLY R ON <![CDATA[I.INQUIRY_ID = R.INQUIRY_ID]]>
		<if test="inquiry_id != null">
		<![CDATA[WHERE I.INQUIRY_ID = #{inquiry_id}]]>
		</if>
		ORDER BY QNADAY DESC
	</select>
	
	<insert id="adminReplyInquiry" parameterType="qna_reply">
		<![CDATA[
		INSERT INTO INQUIRY_REPLY(INQUIRY_REPLY_ID,MANAGER_ID,INQUIRY_ID,CONTENTS,REPLYDAY) 
		VALUES (INQUIRY_REPLY_SEQUENCE.NEXTVAL,#{manager_id},#{inquiry_id},#{contents},SYSDATE)
		]]>
	</insert>
	
	<select id="viewInventory" parameterType="inventory" resultType="inventory">
		SELECT IVN.INVENTORY_NO INVENTORY_NO, P.IMG_URL IMG_URL, IVN.PROD_NO PROD_NO, 
		P.PROD_NAME PROD_NAME, IVN.EXIST_QTY EXIST_QTY, IVN.EXIST_PRICE, EXIST_PRICE, 
		IVN.STOCK_IN_QTY STOCK_IN_QTY, IVN.STOCK_IN_PRICE STOCK_IN_PRICE, IVN.UPDATE_DATE UPDATE_DATE
		FROM INVENTORY IVN
		INNER JOIN PRODUCT P ON <![CDATA[IVN.PROD_NO = P.PROD_NO]]>
	</select>

</mapper>